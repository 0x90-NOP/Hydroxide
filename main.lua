--[[ <
                                                                                                                                                               
                                   **.     .*.                    *%\                              (*)         *%\                                             
                                   &&/    ./&/                    *&|                    .       .             *&|                                             
                                   &&/    .(&/ *#(    ./#.  .*%%(/(&| .#/*%%*  .*#%%#,   (/.   (#. .#/   .*%%(/(&|   .*#%#(\                                   
                                   &@%#####&@/  ,#%* .&%*  *&(    *&| .@%,   ,@#,    %@#  /&@&&,   ,&(  *&(    *&|  (&/,,,*#%                                 
                                   &&/    .(&/   .@%,(%*   \&/    *&| .,     ,@(.    #@#  ,#@@&    ,&(  \&/    *&|  (&/,,,,,.                                  
                                   ##*     *#*    ./@#      \(%%(**#/ .#(.     ,(%%%#.  .#*    #%. .#/   \(%%(**#/   \%%%%%#,                                  
                                                  ,%#,                                                                                                         
                                                  (&*                                                                                                           
                                                                                                                                                               
                                                                                                                                                               
                                                                                                             ..,,,,,,,***********,,.                            
                                                                                                      ...,,,,,,,,,,,,,,,,,,,,**********,.                      
                                                                                                   .,,,,,,,,,,,,,,,,,,,,,,,,,,,,,**********,                   
                                                                                               ,,,,,......................,,,,,,,,,,,,**********,              
                                                                                             ,,,..............................,,,,,,,,,,***********,           
                                                   .,,//(###%%%%%%%%%%%%%%%##((/*,.        .,,.................................,,,,,,,,,,************.         
                                            .*/(#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##(*,............              ............,,,,,,,,,,************,.       
                                   ,/(%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%(*.......                        ..........,,,,,,,,,*************,    
                                ./(%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%/,......                           ........,,,,,,,,,***********//**    
                             ,*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*......                             .......,,,,,,,,,************///,   
                          ,/%%%%%%%%%%%%%%%%###############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*.....                               ......,,,,,,,,,************///**,  
                     ,(%%%%%%%%%%%###############################%%%%%%%%%%%%%%%%%%%%%%%*.....                               .......,,,,,,,,,************/////, 
                   *(%%%%%%%%%%#####################################%#%%%%%%%%%%%%%%%%%%/,....                               ......,,,,,,,,,*************/////* 
                 .*%%%%%%%%%#########################################%##%%%%%%%%%%%%%%%%(,....                               ......,,,,,,,,,*************////*,
                (#%%%%%%%%################################################%%%%%%%%%%%%%%#/.....                             .......,,,,,,,,,*************/////*
            ,/%%%%%%%#######################################################%%%%%%%%%%%%%%/,.....                         .......,,,,,,,,,,*************//////*
           (%%%%%%%%#########################################################%%%%%%%%%%%%%#/,......                     ........,,,,,,,,,,**************//////*
         ,(%%%%%#%##########################((((((((((((((######################%%%%%%%%%%%#(.........               .........,,,,,,,,,,***************///////*
         (%%%%%%%#######################((((((((((((((((((((((################%%%%%%%%%%%%%%#*...........         ...........,,,,,,,,,,,**************////////*
      .#%%%%%%####################((((/////////////////////////((((################%%%%%%%%%%%%/,......................,,,,,,,,,,,,,,***************/////////,.
     ,(%%%%%%%##################((((//////////////*****///////////(((##############%%%%%%%%%%%%%(,,,...............,,,,,,,,,,,,,,,,*****************/////////. 
    *#%%%%%%###################((((//////////**************////////(((#############%%%%%%%%%%%%%%#/,,,,,,,,,,,,,,,,,,,,,,,,,,,,,******************//////////*  
   .#%%%%%%##################((((////////*********************///////((############%%%%%%%%%%%%%%%%#*,,,,,,,,,,,,,,,,,,,,,,,,,*******************//////////,.  
  ,(%%%%%%%#################(((///////**************************//////((###########%%%%%%%%%%%%%%%%%%%(/*,,,,,,,,,,,,,,,***********************/////////**.    
  (%%%%%%%#################((((///////***************************//////((##########%%%%%%%%%%%%%%%%%%%%%%/*,,,,,,,**************************///////////*.      
 .%%%%%%%%%################(((///////*****************************/////((##########%%%%%%%%%%%%%%%%%%%%%%%%(******************************////////////*.       
./%%%%%%%%#################(((//////******************************/////((##########%%%%%%%%%%%%%%%%%%%%%%%%%%#(/***********************/////////////*,         
*#%%%%%%%%#################(((//////*****************************//////((##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#(/**********////////////////*,.            
(%%%%%%%%%##################(((///////**************************//////((##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&%%#(///////////////////**,.               
#%%%%%%%%%%#################(((///////**************************/////((##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&%%%##(((((//*,,.                    
#%%%%%%%%%%##################(((////////**********************//////((###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&%/.                       
%%%%%%%%%%%%%###################(((//////////*********//////////((############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&%/.                       
%%%%%%%%%%%%%####################((((/////////////////////////(((#############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&%/.                       
#%%%%%%%%%%%%%%#####################((((///////////////////(((##############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&%/.                       
#%%%%%%%%%%%%%%%#######################((((((((/////(((((((################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&*                        
/%%%%%%%%%%%%%%%%%%####################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&(.                        
,#%%%%%%%%%%%%%%%%%%%%%############################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&*                         
./%%%%%%%%%%%%%%%%%%%%%%%#######################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&%.                         
 ,%%%%%%%%%%%%%%%%%%%%%%%#####################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&                          
  *#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&/.                          
  ./%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&%.                           
   .#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&%/                            
    *#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&*                             
      ,%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%(                               
       *#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&/.                               
        .%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%(                                 
         ,(&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%,                                  
           .*#&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&/.                                    
             .#%&%&&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&*                                      
               ,%&&&&&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%(                                        
                .*(&&&&&&&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%(.                                         
                     ,(%&&&&&&&&&&&&&&%%%%&&&&&&&&&&&%&&&&%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%*.                                             
                       /#%&&&&&&&&&&&&&&&&&&&&&%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&/,                                               
                         .(#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%(,                                                  
                            ,/#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%#,.                                                    
                                   ,/(%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%&&&%/,.                                                           
                                       .*(%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%#*,                                                                
                                          .,*##%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%#(,.                                                                   
                                                 .,*(#%%%&&&&&&&&&&&&&&&&&&&&%%%#(/,,                                                                          

Hydroxide :: nerve
    "Hydroxide is a penetration testing tool, used to edge the security of Roblox games."

<< Features:
    > Client Environment "Explorer"
    > Data Manipulation
    > Data Information
    > Code Generation
    > Client Script Viewer
    > Remote Call "Spy"
>>

]]-- >

-- < Delete Clones >
if ui and game.CoreGui:FindFirstChild("Hydroxide") then
    getgenv().ui = nil
    game.CoreGui.Hydroxide:Destroy()
end

-- < Environment Check >
do
    if not getgenv then
        print("<OH-> : Your exploit does not have getgenv")
        return
    end

    local verified = true
    for i,v in next, {
        getrawmetatable = getrawmetatable or debug.getmetatable or false,
        setrawmetatable = setrawmetatable or debug.setmetatable or false,
        getupvalues = debug.getupvalues or getupvalues or getupvals or false,
        getupvalue = debug.getupvalue or getupvalue or getupval or false,
        setupvalue = debug.setupvalue or setupvalue or setupval or false,
        islclosure = islclosure or false,
    } do
        if v then
            getgenv()[i] = v
        else
            verified = false
            print("<OH-> : Your exploit does not have " .. i)
        end
    end

    if not verified then
        warn("<OH-> : Make sure your exploit has all of the functions above, before you use Hydroxide!")
        return
    end
end

-- < Abstractions >
getgenv().abs = {}

abs.isEmpty = function(table)
    local count = 0
    for i,v in next, table do
        count = count + 1
    end
    return count == 0
end

abs.isRoblox = function(check)
    return type(check) ~= typeof(check)
end

abs.getScripts = function()
    local scripts, modules, cache = {}, {}, {}
    for i,v in next, getreg() do 
        if type(v) == 'function' and getfenv(v).script then 
            local scr = getfenv(v).script
            if not cache[scr] and scr.Parent ~= nil then
                if scr:IsA("ModuleScript") then 
                    modules[scr.Name] = v
                else 
                    scripts[scr.Name] = v
                end
                cache[scr] = true
            end
        end
    end

    return scripts, modules
end

-- < Variables >
getgenv().ui = {}
local tableCache = {} 
local interface = game:GetObjects("rbxassetid://3223506759")[1]
local drag = interface.Drag
local body = drag.Body
local border = drag.BorderFrame
local collapse = drag.Collapse

local sidebar = body.Sidebar
local buttonClone = sidebar._G:Clone()
buttonClone.Icon.ImageTransparency = 0
buttonClone.Label.Size = UDim2.new(1, -40, 0, 20)
buttonClone.ClipsDescendants = true
buttonClone.Label.Font = "SourceSans"

sidebar._G:Destroy()

local information = body.Information
local console = body.Console
local misc = body.Miscellaneous.List

for i,v in next, misc:GetChildren() do
    if not v:IsA("UIListLayout") then
        v.Label.MouseButton1Click:Connect(function()
            ui.msg("Woops!", "\"" .. v.Label.Text .. "\" is not available yet!")
        end)

        v.Label.MouseEnter:Connect(function()
            v.Label.TextColor3 = Color3.fromRGB(240, 240, 240)
            v.Label.Font = "SourceSansSemibold"
        end)

        v.Label.MouseLeave:Connect(function()
            v.Label.TextColor3 = Color3.fromRGB(200, 200, 200)
            v.Label.Font = "SourceSans"
        end)
    end
end

local welcome = body.Welcome.Scroll
local changelogs = welcome.ChangeLogs

changelogs.Text = ""
changelogs.TextWrapped = true

for i,v in next, loadstring(game:HttpGet("https://raw.githubusercontent.com/0x90-NOP/Hydroxide/master/change_logs.lua"))() do
    changelogs.Text = changelogs.Text .. "• " .. v .. '\n' 
end

-- < Interface: Message Box >
do
    local messageBox = interface.MessageBox
    messageBox.Button.MouseButton1Click:Connect(function()
        messageBox.Visible = false
        border.Visible = true
    end)

    ui.msg = function(title, message)
        messageBox.Visible = true
        messageBox.Title.Text = title
        messageBox.Content.Text = message
        border.Visible = false
    end
end

-- < Interface: Drag >
do -- creds to @[ Tiffblocks ]
    local dragging
    local dragInput
    local dragStart
    local startPos

    drag.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = drag.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    drag.InputChanged:connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    game:getService("UserInputService").InputChanged:connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            drag.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- < Interface: Information >
ui.showInfo = function(name, data, extra)
    local allExtra = {
        isUpvalue = false,
        isMetatable = false,
    }


end

-- < Interface: Sidebar>
local typeIcons = {
    string = 3285671510,
    number = 3285671510,
    boolean = 3285671510,
    table = 3285651068,
    userdata = 3285664726,
    ['function'] = 3285661880
}

local collapseIcon = {
	["true"] = 3270754211,
	["false"] = 3271004659
}

ui.findRoot = function(obj, root)
	if type(obj) ~= 'userdata' then 
		return
	end

	if obj.Parent == root then 
		return obj
	end

	return ui.findRoot(obj.Parent, root)
end

ui.getMostX = function(elements)
    local current = 0
    for i,v in next, elements do
        if v:IsA("TextButton") and current < v.Position.X.Offset then
            current = v
        end
    end
    return current
end

ui.addButton = function(name, data, parent, options)
    if not options then
        options = {}
    end

    local dataType = type(data)
    local button = buttonClone:Clone()
    local collapse = button.Collapse
    local children 

    if not parent then
        parent = sidebar
    end

    if not options.icon then
        options.icon = typeIcons[dataType]
    end

    button.Parent = parent
    button.Name = name
    button.Label.Text = name
    button.Icon.Image = "rbxassetid://" .. options.icon
    button.Label.MouseEnter:Connect(function()
        button.Label.TextColor3 = Color3.fromRGB(240, 240, 240)
        button.Label.Font = "SourceSansSemibold"
    end)
    button.Label.MouseLeave:Connect(function()
        button.Label.TextColor3 = Color3.fromRGB(200, 200, 200)
        button.Label.Font = "SourceSans"
    end)
    button.Label.MouseButton1Click:Connect(function()
        print(data)
    end)

    local root = ui.findRoot(button, sidebar)

    local createCollapse = function(element)
        children = Instance.new("Frame", button)
        local format = Instance.new("UIListLayout", children)
        local fitChildren = function(element, size)
            element[size] = UDim2.new(0, 165, 0, 0)
            for i,v in next, element:GetChildren() do
                if not v:IsA("UIListLayout") then
                    element[size] = element[size] + UDim2.new(0, 0, 0, v.Size.Y.Offset)
                end
            end
        end

        children.BackgroundTransparency = 1
        children.Position = UDim2.new(0, 10, 0, 20) -- To put it directly under the button, left shift for clearance
        children.Size = UDim2.new(0, 165, 0, 0)
        children.Name = "Children"

        format.SortOrder = "LayoutOrder"

        element.Collapse.Visible = true
        element.Collapse.ClipsDescendants = false
        element.Collapse.MouseEnter:Connect(function()
            element.Collapse.ImageTransparency = 0
        end)
        element.Collapse.MouseLeave:Connect(function()
            element.Collapse.ImageTransparency = 0.5
        end)
        element.Collapse.MouseButton1Click:Connect(function()
            local e = element.Collapse
            local flag = e.ClipsDescendants

            local scripts, modules = abs.getScripts()
            local btn = {}
            btn.resizeTree = function(button, y)
                if button.Parent == sidebar then
                    return
                end
                button.Parent.Size = button.Parent.Size + UDim2.new(0, 0, 0, y)
                return btn.resizeTree(button.Parent, y)
            end

            if flag then -- Collapsed
                button.Size = button.Size - UDim2.new(0, 0, 0, children.Size.Y.Offset)
                children.Size = UDim2.new(0, 165, 0, 0)

                local y = 0 
                for i,v in next, button.Children:GetChildren() do
                    if not v:IsA("UIListLayout") then
                        y = y - v.Size.Y.Offset
                    end
                end

                btn.resizeTree(button, y)
            else -- Opened
                if type(data) == "table" and not tableCache[data] then -- this entire conditional block is to create instances once the client opens a path
                    local cache = {} -- Check for cloned data
                    for i,v in next, data do
                        if not cache[i] then
                            local opts = {}
                            local module
                            if type(v) == 'function' and ({["rbxassetid://3285607721"] = true, ["rbxassetid://3285696601"] = true})[root.Icon.Image] then
                                if scripts[tostring(i)] then
                                    opts.icon = 3285608077
                                elseif modules[tostring(i)] then
                                    opts.icon = 3285656377
                                    module = ui.addButton("Return Type", require(getfenv(v).script), button.Children)
                                end
                            end

                            local datum = ui.addButton(tostring(i), v, button.Children, opts)
                            if datum and module and datum:FindFirstChild("Children") then
                                module.Parent = datum.Children 
                            elseif module and not datum:FindFirstChild("Children") then
                                datum:Destroy()
                                module:Destroy()
                            end

                            cache[i] = true
                        end
                    end
                    
                    tableCache[data] = true
                elseif type(data) == "function" and not tableCache[data] then
                    local filteredEnvironment, filteredUpvalues = {}, {}

                    for i,v in next, getupvalues(data) do
                        if not getrenv()[i] then
                            filteredUpvalues[i] = v
                        end
                    end
                    
                    for i,v in next, getfenv(data) do
                        if i ~= "script" then
                            filteredEnvironment[i] = v
                        end
                    end

                    if not abs.isEmpty(filteredUpvalues) then
                        ui.addButton("Upvalues", filteredUpvalues, button.Children, {showCollapse = true})
                    end

                    if not abs.isEmpty(filteredEnvironment) then
                        ui.addButton("Environment", filteredEnvironment, button.Children, {showCollapse = true})
                    end
                    tableCache[data] = true
                end

                fitChildren(children, "Size")
                button.Size = button.Size + UDim2.new(0, 0, 0, children.Size.Y.Offset)

                local y = 0 
                for i,v in next, button.Children:GetChildren() do
                    if not v:IsA("UIListLayout") then
                        y = y + v.Size.Y.Offset
                    end
                end

                btn.resizeTree(button, y)
            end

            sidebar.CanvasSize = UDim2.new(0, 0, 0, 0)
            fitChildren(sidebar, "CanvasSize")

            e.Image = "rbxassetid://" .. collapseIcon[tostring(flag)]

            element.ClipsDescendants = flag
            e.ClipsDescendants = not flag
        end)

        sidebar.CanvasSize = UDim2.new(0, 0, 0, 0)
        fitChildren(sidebar, "CanvasSize")
    end 

    if options.showCollapse then
        createCollapse(button)
    end

    if ( dataType == 'table' and not abs.isEmpty(data) ) or ( dataType == 'function' and islclosure(data) and not abs.isEmpty(getupvalues(data)) ) then -- Show tables
        local increment = 0
        if type(data) == 'function' then
            for i,v in next, getfenv(data) do
                increment = increment + 1
            end
        end

        if not options.showCollapse then
            if ( type(data) == "function" and ( (getfenv(data).script and increment > 1) or not abs.isEmpty(getupvalues(data)) ) ) or type(data ~= "function") then
                createCollapse(button)
            end
        end
    end

    if getrawmetatable(data) and not abs.isRoblox(data) then -- Show metatables
        if not button.Collapse.Visible then
            createCollapse(button)
        end

        ui.addButton("Metatable", getrawmetatable(data), button.Children)
    end

    return button
end

-- < Runtime >
interface.Parent = game.CoreGui
ui.msg("Thanks for using Hydroxide!", "Check it out on GitHub!\nhttps://github.com/0x90-NOP/Hydroxide")
